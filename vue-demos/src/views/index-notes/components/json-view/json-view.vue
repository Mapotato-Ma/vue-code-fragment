<template>
  <div class="json-view">
    <div class="left">
      <Editor :data="jsonStr" @update:data="updateData"></Editor>
    </div>
    <div class="right" tabindex="0">
      <NestView :data="data" is-root @update-modelValue="dataChange"></NestView>
    </div>
  </div>
</template>

<script lang="ts" setup>
import { Editor, NestView } from '@/common/components';
import { computed, ref } from 'vue';
const data = ref({
  name: 'å¼ æ— å¿Œ',
  age: 21,
  sex: 'ç”·',
  isDied: false,
  address: {
    province: 'åŒ—äº¬',
    city: 'åŒ—äº¬',
    friends: [
      {
        name: 'å‘¨èŠ·è‹¥',
        age: 20,
        sex: 'å¥³'
      }
    ],
    friends33: [
      {
        name: 'å‘¨èŠ·è‹¥',
        age: 20,
        sex: 'å¥³'
      }
    ]
  },
  hobbies: ['åƒé¥­', 'ç¡è§‰', 'ä¹é˜³çœŸç»'],
  friends: [
    {
      name: 'å‘¨èŠ·è‹¥',
      age: 20,
      sex: 'å¥³'
    }
  ],
  friends33: [
    {
      name: 'å‘¨èŠ·è‹¥',
      age: 20,
      sex: 'å¥³'
    }
  ],
  hobbies7: ['åƒé¥­', 'ç¡è§‰', 'ä¹é˜³çœŸç»']
});

const jsonStr = computed(() => {
  return JSON.stringify(data.value, null, 2);
});

const updateData = (value: string) => {
  try {
    data.value = JSON.parse(value);
  } catch (error) {
    console.log('ðŸš€ ~ error ~ 39è¡Œ', error);
  }
};

const dataChange = (value: any) => {
  // data.value = value;
  console.log('ðŸš€ ~ value ~ 69è¡Œ', value);
};
</script>

<style lang="scss" scoped>
.json-view {
  width: 100%;
  height: 100%;
  display: flex;
  .left {
    min-width: 30cqw;
    border: 3px solid #2068ed;
  }
  .right {
    display: flex;
    flex-basis: 70cqw;
    border: 3px solid #2068ed;
    & > div {
      border: none;
    }
  }
}
</style>
